import re

# Function to sanitize names
def sanitize(sheet_name):
    return re.sub(r'\W|^(?=\d)', '_', sheet_name)

# Required sanitized sheet names
required_sheets = ['abc_yy', 'hh_ui', 'ht_ui']

# Get actual sheet names
available_sheets = pd.ExcelFile(file_path).sheet_names

# Map sanitized names to actual ones
sanitized_map = {sanitize(name): name for name in available_sheets}

# Check if all required sanitized names are in the file
missing_sheets = [s for s in required_sheets if s not in sanitized_map]

if missing_sheets:
    raise ValueError(f"Missing required sheets: {', '.join(missing_sheets)}")

# Read them using the actual names
sheet_dfs = {
    s: pd.read_excel(file_path, sheet_name=sanitized_map[s])
    for s in required_sheets
}
