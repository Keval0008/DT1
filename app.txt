import os
import pandas as pd
from openpyxl import load_workbook

folder_path = os.path.dirname(os.path.abspath(__file__))
excel_file = os.path.join(folder_path, 'your_file.xlsx')
password_file = os.path.join(folder_path, 'password.txt')

with open(password_file, 'r') as f:
    password = f.read().strip()

# Load the workbook first to handle password
wb = load_workbook(filename=excel_file, read_only=True, password=password)

# Then read with pandas
df = pd.read_excel(excel_file, engine='openpyxl', password=password)
print(df.head())
