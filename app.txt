from openpyxl import load_workbook
from openpyxl.utils import get_column_letter

# Load your workbook and select the active sheet (you can change this)
wb = load_workbook('your_file.xlsx')
ws = wb.active

# Set the row you want to check
row_num = 1

# Get max column count for row 1
max_col = ws.max_column

# Initialize variables
start_col = 1
prev_value = ws.cell(row=row_num, column=1).value

for col in range(2, max_col + 2):  # +2 to handle the last merge
    curr_value = ws.cell(row=row_num, column=col).value if col <= max_col else None
    
    # Compare current and previous value
    if curr_value != prev_value:
        if prev_value is not None:
            # Merge from start_col to col-1
            if start_col != col - 1:
                start_letter = get_column_letter(start_col)
                end_letter = get_column_letter(col - 1)
                merge_range = f"{start_letter}{row_num}:{end_letter}{row_num}"
                ws.merge_cells(merge_range)
        # Update pointers
        start_col = col
        prev_value = curr_value

# Save the updated file
wb.save('your_file_merged.xlsx')
