import os
import xlwings as xw

folder_path = os.path.dirname(os.path.abspath(__file__))
excel_file = os.path.join(folder_path, 'your_file.xlsx')
password_file = os.path.join(folder_path, 'password.txt')

with open(password_file, 'r') as f:
    password = f.read().strip()

app = xw.App(visible=False)
wb = app.books.open(excel_file, password=password)
sheet = wb.sheets[0]

# Read data
print(sheet.range('A1').value)

# Read entire used range
data = sheet.used_range.value
for row in data:
    print(row)

wb.close()
app.quit()
