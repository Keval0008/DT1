import tkinter as tk
from tkinter import filedialog, messagebox
import os
import shutil

def select_files():
    files = filedialog.askopenfilenames(title="Select Files")
    file_list.clear()
    file_list.extend(list(files))
    file_label.config(text=f"{len(file_list)} files selected")

def select_folder():
    folder = filedialog.askdirectory(title="Select Destination Folder")
    if folder:
        folder_path.set(folder)

def save_files():
    if not file_list:
        messagebox.showerror("Error", "No files selected")
        return
    if not folder_path.get():
        messagebox.showerror("Error", "No folder selected")
        return

    keyword = keyword_entry.get()
    mode = prefix_suffix.get()

    for file in file_list:
        base_name = os.path.basename(file)
        name, ext = os.path.splitext(base_name)

        if mode == "prefix":
            new_name = f"{keyword}_{name}{ext}"
        else:
            new_name = f"{name}_{keyword}{ext}"

        dest_path = os.path.join(folder_path.get(), new_name)
        shutil.copy(file, dest_path)

    messagebox.showinfo("Success", f"{len(file_list)} files saved successfully!")

# Tkinter UI Setup
root = tk.Tk()
root.title("File Rename & Save Tool")
root.geometry("400x300")

file_list = []
folder_path = tk.StringVar()
prefix_suffix = tk.StringVar(value="prefix")

# Widgets
tk.Button(root, text="Select Files", command=select_files).pack(pady=5)
file_label = tk.Label(root, text="No files selected")
file_label.pack()

tk.Button(root, text="Select Folder", command=select_folder).pack(pady=5)
tk.Label(root, textvariable=folder_path).pack()

tk.Label(root, text="Keyword:").pack(pady=5)
keyword_entry = tk.Entry(root)
keyword_entry.pack()

tk.Radiobutton(root, text="Add as Prefix", variable=prefix_suffix, value="prefix").pack()
tk.Radiobutton(root, text="Add as Suffix", variable=prefix_suffix, value="suffix").pack()

tk.Button(root, text="Save Files", command=save_files, bg='green', fg='white').pack(pady=10)

root.mainloop()
