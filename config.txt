import pandas as pd
from typing import Iterable, Optional

def move_columns_to_end(
    df: pd.DataFrame,
    cols: Iterable[str],
    prefix: Optional[str] = " | |",   # used only to detect prefixed variants; no renaming
) -> pd.DataFrame:
    """
    Move selected columns to the end of the DataFrame in the exact order given in `cols`.
    - No renaming is performed.
    - If a 'prefixed' variant exists (e.g., ' | |Comments'), it is used instead of the base.
    - Columns not present are skipped silently.
    """
    df = df.copy()
    current = list(df.columns)

    # For each base name, choose the present variant:
    tail = []
    for base in cols:
        candidates = [base]
        if prefix:
            candidates.append(f"{prefix}{base}")

        # add any candidates found, preserving their current order in df
        found = [c for c in current if c in candidates]
        tail.extend(found)

    # Remove duplicates while preserving order (in case both base and prefixed were added twice)
    seen = set()
    tail = [c for c in tail if not (c in seen or seen.add(c))]

    others = [c for c in current if c not in tail]
    return df[others + tail]
