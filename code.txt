import pandas as pd

# Example setup
df = pd.DataFrame(columns=[f'col{i}' for i in range(1, 101)])
cols_to_order = ['col50', 'col30', 'col70', 'col10', 'col90']

# 1. Get current column list
cols = list(df.columns)

# 2. Find first appearance index among these columns
indices = [cols.index(col) for col in cols_to_order if col in cols]
if not indices:
    raise ValueError("None of the specified columns found in dataframe.")
first_index = min(indices)

# 3. Remove the columns from their current positions
cols_reordered = [col for col in cols if col not in cols_to_order]

# 4. Insert them back in required order at first_index
for i, col in enumerate(cols_to_order):
    cols_reordered.insert(first_index + i, col)

# 5. Reorder dataframe
df = df[cols_reordered]

# âœ… Now, df has cols_to_order at first_index onwards in the given order
print(df.columns[first_index:first_index + len(cols_to_order)])
