def input_automation(folder_path):
    try:
        # Ask user where to save the file
        output_file = filedialog.asksaveasfilename(
            defaultextension=".xlsx",
            filetypes=[("Excel files", "*.xlsx")],
            title="Save output Excel file"
        )
        
        if not output_file:  # User cancelled
            return {'status': 'cancelled', 'message': 'Operation cancelled by user'}
        
        # Your sheet processing logic
        with pd.ExcelWriter(output_file, engine="openpyxl") as writer:
            for sheet_name, df in sheet_dfs.items():
                df.to_excel(writer, sheet_name=sheet_map[sheet_name], index=False)
        
        return {
            'status': 'success',
            'message': f'Excel file saved to {output_file}',
            'output_path': output_file
        }
    except Exception as e:
        return {'status': 'error', 'message': str(e)}
