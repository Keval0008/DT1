import win32com.client

# Specify your file path and password
file_path = r"C:\path\to\your\file.xlsx"
password = "your_password"

# Initialize Excel Application
excel = win32com.client.Dispatch("Excel.Application")
excel.Visible = False  # Keep Excel hidden

# Open workbook with password
workbook = excel.Workbooks.Open(file_path, False, True, None, password)

# Access a specific sheet, for example, the first sheet
sheet = workbook.Sheets(1)

# Read cell values (example: A1 value)
value = sheet.Range("A1").Value
print("Value in A1:", value)

# Loop through rows and columns as needed
# Example: reading first 5 rows and columns
for row in range(1, 6):
    for col in range(1, 6):
        print(sheet.Cells(row, col).Value, end="\t")
    print()

# Close workbook and quit Excel
workbook.Close(False)
excel.Quit()
