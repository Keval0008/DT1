import pandas as pd

# df = your Excel data loaded with pd.read_excel(...)

# Sample structure assumptions
# Let's say these are the CGUs and their starting column indices
cgu_positions = {
    'WPB': 1,
    'CMB': 7,
    'CC': 13
}

# These are the row indices for labels
row_actual_forecast_frp = 1  # Row under CGU name
row_time_labels = 2          # Row under 'Actual', 'OCT Forecast', 'FRP'

available_labels_by_cgu = {}

for cgu, start_col in cgu_positions.items():
    labels = []
    col = start_col
    
    # Loop through columns from this CGU block until you hit an empty cell or known break
    while True:
        header = df.iloc[row_actual_forecast_frp, col]
        
        if pd.isna(header):
            break  # Stop at gap or end
        
        header = str(header).strip().lower()
        
        if header in ['actual', 'frp']:  # We want to include these only
            time_label = df.iloc[row_time_labels, col]
            if not pd.isna(time_label):
                labels.append(str(time_label).strip())
        
        col += 1  # Move to next column in this CGU block
    
    available_labels_by_cgu[cgu] = labels

# Now available_labels_by_cgu is a dict like:
# {'WPB': ['1Q24', '2Q24', ..., '2029'], 'CMB': [...], ...}
