import msoffcrypto
import pandas as pd
from io import BytesIO

# Step 1: Read the password from pass.txt
with open('pass.txt', 'r') as f:
    password = f.read().strip()

# Step 2: Decrypt the Excel file
decrypted = BytesIO()
with open('your_file.xlsx', 'rb') as file:
    office_file = msoffcrypto.OfficeFile(file)
    office_file.load_key(password=password)
    office_file.decrypt(decrypted)

# Step 3: Read decrypted content into a DataFrame
decrypted.seek(0)  # Reset pointer to start
df = pd.read_excel(decrypted, engine='openpyxl')

print(df.head())
