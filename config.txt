def show_advanced_validation_report(errors, proceed_callback):
    popup = tk.Toplevel()
    popup.title("Advanced Validation Report")
    popup.geometry("600x400")
    popup.grab_set()
    
    # Create downloadable report
    report_text = f"ADVANCED VALIDATION REPORT\nGenerated on: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}\n\n"
    report_text += f"Total validation errors: {len(errors)}\n\n"
    
    for error in errors:
        report_text += f"File: {os.path.basename(error['file'])}\n"
        report_text += f"Row: {error['row']}, Role: {error['role']}\n"
        report_text += f"PS ID: {error['ps_id']}, Name: {error.get('name', 'N/A')}\n"
        if 'manual_name' in error:
            report_text += f"Correct Name: {error['manual_name']}\n"
        if 'grade' in error:
            report_text += f"Current Grade: {error['grade']}\n"
        report_text += f"Error: {error['description']}\n"
        report_text += "-" * 50 + "\n"
    
    # Text widget to display report
    text_widget = tk.Text(popup, wrap=tk.WORD, width=70, height=20)
    text_widget.insert(tk.END, report_text)
    text_widget.config(state=tk.DISABLED)
    text_widget.pack(padx=10, pady=10, fill=tk.BOTH, expand=True)
    
    # Scrollbar
    scrollbar = tk.Scrollbar(popup, orient=tk.VERTICAL, command=text_widget.yview)
    text_widget.configure(yscrollcommand=scrollbar.set)
    scrollbar.pack(side=tk.RIGHT, fill=tk.Y)
    
    def save_report():
        report_path = filedialog.asksaveasfilename(
            defaultextension=".txt",
            filetypes=[("Text files", "*.txt"), ("All files", "*.*")],
            title="Save Validation Report"
        )
        if report_path:
            with open(report_path, 'w') as f:
                f.write(report_text)
            messagebox.showinfo("Success", f"Report saved to: {report_path}")
    
    button_frame = tk.Frame(popup)
    button_frame.pack(pady=10)
    
    tk.Button(button_frame, text="Download Report", command=save_report).pack(side=tk.LEFT, padx=5)
    tk.Button(button_frame, text="Continue to Save", command=lambda: [proceed_callback(), popup.destroy()]).pack(side=tk.RIGHT, padx=5)
