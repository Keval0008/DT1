import pandas as pd

# Load the Excel file
file_path = 'your_file.xlsx'
df = pd.read_excel(file_path, header=None)  # No header, so we can read all raw data

# Step 1: Find the cell with "Return To Index"
match = df.isin(["Return To Index"])
row_idx, col_idx = match.stack()[match.stack()].index[0]

# Step 2: Find the columns with years from 1990 to 2054 in the same row
year_range = list(map(str, range(1990, 2055)))
year_cols = df.loc[row_idx].isin(year_range)
year_col_indices = df.loc[row_idx][year_cols].index.tolist()
year_labels = df.loc[row_idx, year_col_indices].tolist()

# Step 3: Find the row index of "UAE" in the same column as "Return To Index"
uae_col = col_idx
uae_row_idx = df[df[uae_col] == "UAE"].index[0]

# Step 4: Extract values from UAE row under each year column
values = []
for col in year_col_indices:
    val = df.at[uae_row_idx, col]
    values.append(val)

# Step 5: Create the final DataFrame
result_df = pd.DataFrame({
    'entity': ['UAE'],
    **{year: [val] for year, val in zip(year_labels, values)}
})

print(result_df)
